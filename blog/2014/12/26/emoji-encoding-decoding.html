<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" /> 
    <title>Encoding and Decoding Emoji for Cross platform &#8211; Madhur Ahuja</title>
    

    <meta name="author" content="Madhur Ahuja" />
    <meta name="description" content=" Encoding and Decoding Emoji for Cross platform" />

    <link rel="start" href="/" />

    <link rel="alternate" type="application/atom+xml" href="http://feeds.feedburner.com/madhur" title="RSS feed" />
    <link rel="shortcut icon" href="http://www.gravatar.com/avatar/5352cde0b084abcd6d4d783c08a51c76?s=16" />

    <link rel="stylesheet" href="/files/css/bootstrap.min.css" type="text/css" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/files/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="/files/css/jquery.fancybox.css" type="text/css" />

    <link rel="stylesheet" type="text/css" href="/files/css/styles.css" /> 
    <link rel="stylesheet" type="text/css" href="/files/css/syntax.css" /> 

    <link rel="stylesheet" type="text/css" media="print" href="/files/css/print.css"> 

    <script src="/files/js/vendor/pace.min.js" type="text/javascript"></script>
</head>

<body>

    <div class="container">

        <header id="header" class="row">

            <nav id="navigation" class="navbar navbar-inverse navbar-fixed-top " role="navigation">
    <div class="container">

    <div class="navbar-header">

     <div class="hidden-md hidden-sm hidden-lg searchli">

                <form method="get" role="search" id="searchform" action="/results" onsubmit="return checkfrm_search();">

                    <div class="form-group">
                        <input type="search" required id="q2" name="q" value="" class="form-control mobile" placeholder="Search" />
                    </div>
                </form>
        </div>

        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mainmenu">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <!--  <a class="navbar-brand " href="/">Home</a> -->
    </div>

    <div class="collapse navbar-collapse" id="mainmenu">
        <ul id="nav" class="nav navbar-nav">
            
            <li><a class="home" href="/">Home</a>
            </li>
            <li><a class="blog" href="/blog">Blog</a>
            </li>
            <!--<li><a class="work" href="/work">Resume</a></li>-->
            <li><a class="code" href="/projects">Work</a>
            </li>
            <!--<li><a class="papers" href="/papers">Papers</a></li>-->
            <li><a class="info" href="/info">About</a>
            </li>
            <li><a class="contact" href="/contact">Contact</a>
            </li>

        </ul>

        <ul class="nav navbar-nav visible-md visible-lg visible-sm searchbox">
            <li>
                <form method="get" role="search" id="searchform" action="/results" onsubmit="return checkfrm_search();">

                    <div class="form-group">
                        <input type="search" required id="q1" name="q" value="" class="form-control desktop" placeholder="Search" />
                    </div>
                </form>
            </li>
        </ul>


        <ul class="nav-icons navbar-right nav navbar-nav visible-md visible-lg">
            <li><a href="http://www.linkedin.com/in/madhurahuja"><i class="fa fa-linkedin-square fa-3x"></i></a>
            </li>
            <li><a href="https://github.com/madhur"><i class="fa fa-github fa-3x"></i></a>
            </li>
            <li><a href="http://feeds.feedburner.com/madhur"><i class="fa fa-rss-square fa-3x"></i></a>
            </li>
        </ul>


    </div>

</div>
</nav>


        </header>

        <div id="content" class="row">

            <section>

	<div id="blogcontent">

		<!--<aside class="postmeta col-md-3 hidden-print visible-md visible-lg">

			

		</aside>-->

		<article id="blog-article" class="post col-md-12 clearfix">

				<header><h1>Encoding and Decoding Emoji for Cross platform</h1></header>
			
					<!-- Place this tag where you want the +1 button to render -->
<div class="row social hidden-xs">
    <div class="col-md-2 col-sm-2">
        <time datetime="2014-12-26 00:00:00 +0530" pubdate="pubdate"
            >26 December 2014</time
        >
    </div>
    <div class="social-icon col-md-2 col-sm-2">
       <a href="https://twitter.com/madhur25?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @madhur25</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    </div>
    <div class="social-icon col-md-1 col-sm-2">
        <a
            href="https://twitter.com/share?ref_src=twsrc%5Etfw"
            class="twitter-share-button"
            data-via="madhur25"
            data-show-count="false"
            >Tweet</a
        >
        <script
            async
            src="https://platform.twitter.com/widgets.js"
            charset="utf-8"
        ></script>
    </div>
    <div class="social-icon col-md-1 col-sm-2">
        <script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
        <script type="IN/Share" data-counter="right"></script>
    </div>

    <!-- <div class="social-icon col-md-1 col-sm-2">
        <a
            href="http://bufferapp.com/add"
            class="buffer-add-button"
            data-count="horizontal"
            >Buffer</a
        >
        <script
            type="text/javascript"
            src="https://d389zggrogs7qo.cloudfront.net/js/button.js"
        ></script>
    </div> -->
    <div class="social-icon col-md-1 col-sm-2">
        <a
            data-pocket-label="pocket"
            data-pocket-count="horizontal"
            class="pocket-btn"
            data-lang="en"
        ></a>
        <script type="text/javascript">
            !(function (d, i) {
                if (!d.getElementById(i)) {
                    var j = d.createElement("script");
                    j.id = i;
                    j.src = "https://widgets.getpocket.com/v1/j/btn.js?v=1";
                    var w = d.getElementById(i);
                    d.body.appendChild(j);
                }
            })(document, "pocket-btn-js");
        </script>
    </div>
    <!-- <div class="social-icon col-md-2 col-sm-2">
        <script
            type="text/javascript"
            src="//www.redditstatic.com/button/button1.js"
        ></script>
    </div> -->
</div>


			<hr style="margin-top:0px" />


			 <p>Recently, I have been working on an Android app which communicates with a web platform. One of the challenges we have been faced with is cross platform emoji solution. There are just too many emoji standards out there. There is no standard as of now although Google have come together to formalize <a href="http://www.unicode.org/~scherer/emoji4unicode/snapshot/full.html">Emoji Symbols</a></p>

<p>GitHub introduced <a href="https://github.com/blog/816-emoji">emoji pngs</a> and here you see that in action :smile: throughout their application. Campfire <a href="https://signalvnoise.com/posts/3059-2011-year-end-campfire-feature-blowout">supports emoji</a>. Both GitHub, Campfire, and others support a simple set of codes to inject these pngs into an html page. <a href="http://www.emoji-cheat-sheet.com/">http://www.emoji-cheat-sheet.com/</a> has emerged to guide users and has almost formalized how these codes should work.</p>

<p>Most of the above techniques can be categorized into three basic categories:</p>

<ul>
  <li>
    <p><strong>Colon:</strong> The emojis are converted to their colon style strings. This is simple to save in the database since its just a string.
See the examples: <a href="http://www.emoji-cheat-sheet.com/">http://www.emoji-cheat-sheet.com/</a>. <a href="https://web.telegram.org/#/im">Web interface of telegram</a> uses this technique of rendering and storing emoji. <a href="https://help.github.com/articles/writing-on-github/">Github flavored markdown</a> also uses this.</p>
  </li>
  <li>
    <p><strong>UTF-8 Characters:</strong> Emojis are mapped to their Unicode characters.  The advatage of this method is that some platforms (such as Android, iOS) can render them automatically as emoji unlike colon style encoding which almost always require decoding. On the disadvantage, Saving them in databases require special handling. See <a href="#db">note below</a>.
A comprehensive list of unicode codes can be obtained from <a href="http://apps.timwhitlock.info/emoji/tables/unicode">http://apps.timwhitlock.info/emoji/tables/unicode</a></p>
  </li>
  <li>
    <p><strong>HTML:</strong> Emojis are converted to HTML <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> tags rendering each emoji as an image either from the single image or a sprite. 
This is the least useful method to adopt as its not cross platform. There is no standardization of Emoji sprite images and hence you will never be sure that target platform has the same emoji images. Though, this solution works perfect for a single isolated website.</p>
  </li>
</ul>

<h2 id="our-solution---github-repo-and-demo-page">Our Solution - <a href="https://github.com/madhur/angular-emoji-popup">Github Repo</a> and <a href="http://coraza.github.io/angular-emoji-popup">demo page</a></h2>

<p>Since we are using AngularJs as our frontend, We have come up with an AngularJs directive and set of filters to handle all of above cases for Emoji. The solution supports encoding and decoding emoji from various formats. For us, We decided to go with storing Emoji as UTF-8 characters for the simple reason that Android can render them natively and hence, no special effort is required to implement this on Android side. Though, it did require tweaking our MySql tables and database to switch from <code class="language-plaintext highlighter-rouge">utf8</code> to <code class="language-plaintext highlighter-rouge">utf8mb4</code>. I will not go into the details of their differences.</p>

<p>I also realize that this might be a far from perfect solution especially when we plan to introduce support more devices such as iOS and Windows Phone. But, this works for us perfectly and I believe changing it in future will not be difficult.</p>

<p>Feel free to check out tis project, fork and send me pull requests for any issues or enhancements.</p>

<p>This solution utilizes snippets and ideas from following awesome open source projects:</p>

<ul>
  <li><a href="https://github.com/arvida/emoji-cheat-sheet.com">emoji-cheat-sheet</a> - Complete reference for emoji in colon style</li>
  <li><a href="https://github.com/diy/jquery-emojiarea">jquery-emojiarea</a> - We wrapped this awesome Jquery plugin in angular directive</li>
  <li><a href="https://github.com/jamesflorentino/nanoScrollerJS">nanoScrollerJS</a> - The above jquery plugin utilzes nanoScroller as its scrollbar</li>
  <li><a href="https://github.com/iamcal/js-emoji">js-emoji</a></li>
</ul>

<p><a name="db"></a></p>
<h2 id="using-mysql-for-storage">Using MySQL for storage</h2>
<p>The following text is taken verbatim from <a href="https://github.com/iamcal/js-emoji">https://github.com/iamcal/js-emoji</a></p>

<blockquote>
  <p>Some special care may be needed to store emoji in your database. While some characters (e.g. Cloud, U+2601) are
within the Basic Multilingual Plane (BMP), others (e.g. Close Umbrella, U+1F302) are not. As such, 
they require 4 bytes of storage to encode each character. Inside MySQL, this requires switching from <code class="language-plaintext highlighter-rouge">utf8</code> 
storage to <code class="language-plaintext highlighter-rouge">utf8mb4</code>.</p>
</blockquote>

<blockquote>
  <p>You can modify a database and table using a statement like:</p>
</blockquote>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">ALTER DATABASE my_database DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;</code>
 <code class="language-plaintext highlighter-rouge">ALTER TABLE my_table CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;</code></p>
</blockquote>

<blockquote>
  <p>You will also need to modify your connection character set.</p>
</blockquote>

<blockquote>
  <p>You don’t need to worry about this if you translate to colon syntax before storage.</p>
</blockquote>

			<footer>
				<div class="blocked tags">
					<p>
					
						<a href="/blog/tags/angularjs">AngularJs</a> |
					
						<a href="/blog/tags/emoji">Emoji</a> |
					
					</p>
				</div>
			</footer>
			
			<br/>
		
			
			
			<div class="hr"></div>

		


			<!-- Discus Comments -->
			<div id="disqus_thread"></div>

			
			<!-- Enable Disqus comments -->
			<script type="text/javascript">
  var disqus_developer = 0; // developer mode is on
  var disqus_shortname = 'madhur';
  var disqus_identifier = '/2014/12/26/emoji-encoding-decoding/';
  var disqus_title = 'Encoding and Decoding Emoji for Cross platform';
  var disqus_url = 'https://madhur.co.in/blog/2014/12/26/emoji-encoding-decoding.html';
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();

</script>

			
			
			
			

		</article>

		<div class="c">&nbsp;</div>

	</div>

	
</section>
 
<div class="c">&nbsp;</div>


  

 

 



        </div>


        <footer id="footer" class="row">

            <p id="copyright">
                &copy; 2011-2021 Madhur Ahuja
            </p>
            <p id="poweredby" class="visible-lg visible-md">
                Powered by
                <a href="http://jekyllrb.com" title="A static, minimalist CMS">Jekyll</a>,
                <a href="http://github.com/">Github</a> and
                <a href="http://disqus.com">Disqus</a>.
            </p>

            <div class="c">&nbsp;</div>


        </footer>


    </div>

    <script data-main="/files/js/app" src="/files/js/require.js"></script>  <script type="text/javascript">
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-23769089-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script> 

    <!-- serviceWorker.html -->
    <script>
        if ('serviceWorker' in navigator) {

            navigator.serviceWorker.getRegistrations().then(function (registrations) {
                for (let registration of registrations) {
                    registration.unregister()
                }
            })
        }

// if ('serviceWorker' in navigator) {
//     navigator.serviceWorker.register('/serviceWorker.js').then(function(reg) {
//         if (!reg.installing) return;
//         console.log("[*] ServiceWorker is installing...");

//         var worker = reg.installing;
//         worker.addEventListener('statechange', function() {
//             if (worker.state == 'redundant') {
//                 console.log('[*] Install failed');
//             }
//             if (worker.state == 'installed') {
//                 console.log('[*] Install successful!');
//             }
//         });
//     });
// }

    </script>

</body>

</html>