<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" />
    
        <title>Making AngularJs play nice with Social sharing &#8211; Madhur Ahuja</title>
    

    <meta name="author" content="Madhur Ahuja" />
    <meta name="description" content=" Making AngularJs play nice with Social sharing" />

    <link rel="start" href="/" />

    <link rel="alternate" type="application/atom+xml" href="http://feeds.feedburner.com/madhur" title="RSS feed" />
    <link rel="shortcut icon" href="http://www.gravatar.com/avatar/5352cde0b084abcd6d4d783c08a51c76?s=16" />

    <link rel="stylesheet" href="/files/css/bootstrap.min.css" type="text/css" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/files/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="/files/css/jquery.fancybox.css" type="text/css" />

    <link rel="stylesheet" type="text/css" href="/files/css/styles.css" />
    
    
    <link rel="stylesheet" type="text/css" href="/files/css/syntax.css" />
    

    <link rel="stylesheet" type="text/css" media="print" href="/files/css/print.css">

     
   
    <script src="/files/js/vendor/pace.min.js" type="text/javascript"></script>
</head>

<body>

    <div class="container">
       
            <header id="header" class="row">

                <nav id="navigation" class="navbar navbar-inverse navbar-fixed-top " role="navigation">
    <div class="container">

    <div class="navbar-header">

     <div class="hidden-md hidden-sm hidden-lg searchli">

                <form method="get" role="search" id="searchform" action="/results" onsubmit="return checkfrm_search();">

                    <div class="form-group">
                        <input type="search" required id="q2" name="q" value="" class="form-control mobile" placeholder="Search" />
                    </div>
                </form>
        </div>

        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mainmenu">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <!--  <a class="navbar-brand " href="/">Home</a> -->
    </div>

    <div class="collapse navbar-collapse" id="mainmenu">
        <ul id="nav" class="nav navbar-nav">
            
            <li><a class="home" href="/">Home</a>
            </li>
            <li><a class="blog" href="/blog">Blog</a>
            </li>
            <!--<li><a class="work" href="/work">Resume</a></li>-->
            <li><a class="code" href="/projects">Work</a>
            </li>
            <!--<li><a class="papers" href="/papers">Papers</a></li>-->
            <li><a class="info" href="/info">About</a>
            </li>
            <li><a class="contact" href="/contact">Contact</a>
            </li>

        </ul>

        <ul class="nav navbar-nav visible-md visible-lg visible-sm searchbox">
            <li>
                <form method="get" role="search" id="searchform" action="/results" onsubmit="return checkfrm_search();">

                    <div class="form-group">
                        <input type="search" required id="q1" name="q" value="" class="form-control desktop" placeholder="Search" />
                    </div>
                </form>
            </li>
        </ul>


        <ul class="nav-icons navbar-right nav navbar-nav visible-md visible-lg">
            <li><a href="http://www.linkedin.com/in/madhurahuja"><i class="fa fa-linkedin-square fa-3x"></i></a>
            </li>
            <li><a href="https://github.com/madhur"><i class="fa fa-github fa-3x"></i></a>
            </li>
            <li><a href="http://feeds.feedburner.com/madhur"><i class="fa fa-rss-square fa-3x"></i></a>
            </li>
        </ul>


    </div>

</div>
</nav>


            </header>
       
        <div id="content" class="row">

            <section>

	<div id="blogcontent">

		<!--<aside class="postmeta col-md-3 hidden-print visible-md visible-lg">

			

		</aside>-->

		<article id="blog-article" class="post col-md-12 clearfix">

				<header><h1>Making AngularJs play nice with Social sharing</h1></header>
			
					<!-- Place this tag where you want the +1 button to render -->
<div class="row social hidden-xs">
	<div class="col-md-2 col-sm-2">
		<time datetime="2016-04-09 00:00:00 +0530" pubdate="pubdate">09 April 2016</time>
	</div>
    <div class="social-icon col-md-1 col-sm-1">
        <div class="g-plusone" data-size="small"></div>
    </div>
    <div class="social-icon col-md-1 col-sm-2">
        <a href="https://twitter.com/share?count=vertical" class="twitter-share-button" data-via="madhur25">Tweet</a>
        <script>
        ! function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0],
                p = /^http:/.test(d.location) ? 'http' : 'https';
            if (!d.getElementById(id)) {
                js = d.createElement(s);
                js.id = id;
                js.src = p + '://platform.twitter.com/widgets.js';
                fjs.parentNode.insertBefore(js, fjs);
            }
        }(document, 'script', 'twitter-wjs');
        </script>
    </div>
    <div class="social-icon col-md-1 col-sm-2">
        <script src="//platform.linkedin.com/in.js" type="text/javascript">
        lang: en_US
        </script>
        <script type="IN/Share" data-counter="right"></script>
    </div>

    <div class="social-icon col-md-1 col-sm-2">
        <a href="http://bufferapp.com/add" class="buffer-add-button" data-count="horizontal">Buffer</a>
        <script type="text/javascript" src="https://d389zggrogs7qo.cloudfront.net/js/button.js"></script>
    </div>
    <div class="social-icon col-md-1 col-sm-2">
        <a data-pocket-label="pocket" data-pocket-count="horizontal" class="pocket-btn" data-lang="en"></a>
        <script type="text/javascript">
        ! function(d, i) {
            if (!d.getElementById(i)) {
                var j = d.createElement("script");
                j.id = i;
                j.src = "https://widgets.getpocket.com/v1/j/btn.js?v=1";
                var w = d.getElementById(i);
                d.body.appendChild(j);
            }
        }(document, "pocket-btn-js");
        </script>
    </div>
				<div class="social-icon col-md-2 col-sm-2">
<script type="text/javascript" src="//www.redditstatic.com/button/button1.js"></script>
				</div>

	
</div>
<!-- Place this tag after the last plusone tag -->
<!-- Place this tag after the last +1 button tag. -->
<script type="text/javascript">
(function() {
    var po = document.createElement('script');
    po.type = 'text/javascript';
    po.async = true;
    po.src = 'https://apis.google.com/js/platform.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(po, s);
})();
</script>


			<hr style="margin-top:0px" />


			 <p>Recently, We were designing a mobile web view for the news article shared on the app. I simply choose AngularJs for the ease of use and flexibility it provies.</p>

<p>However, after complete implementation. When someone tried to share the story on Facebook, we saw this:</p>

<p><img src="/images/Blog/angular1.png" alt=""></p>

<p>This happens because of social media sites like <a href="">Facebook</a> do not evalaute Javascript while fetching the meta tags. In our case, the meta tags were defined like this:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;title</span> <span class="na">ng-bind=</span><span class="s">"title"</span><span class="nt">&gt;&lt;/title&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:title"</span> <span class="na">content=</span><span class="s">"{{ data.caption }}"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image"</span> <span class="na">content=</span><span class="s">"{{ data.xImage}}"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:description"</span> <span class="na">content=</span><span class="s">"{{ data.caption }}"</span> <span class="nt">/&gt;</span></code></pre></figure>

<p>We were relying on Angular&#39;s interpolation to evaluate the meta tags which didn&#39;t work since AngularJs is entirely executed on client side. This caused facebook to show raw values i.e. 
``</p>

<p>To solve this problem, we moved the meta tags evaluation to server side. Since we were using Java stack along with Spring, it was easy to do so. We made sure that our HTML markup was filtered through JSP tags. It was as easy as adding these directives on top of page:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="err">&lt;</span>%@ page isELIgnored="false" %&gt;
<span class="err">&lt;</span>%@ page language="java" contentType="text/html; charset=ISO-8859-1"
         pageEncoding="ISO-8859-1"%&gt;
<span class="err">&lt;</span>%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;</code></pre></figure>

<p>Now with JSTL tags in place, we replaced the meta tags with JPS tags:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"> <span class="nt">&lt;title&gt;&lt;c:out</span> <span class="na">value=</span><span class="s">"${title}"</span><span class="nt">&gt;&lt;/c:out&gt;&lt;/title&gt;</span>
 <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:title"</span> <span class="na">content=</span><span class="s">"&lt;c:out value="</span><span class="err">${</span><span class="na">title</span><span class="err">}"</span><span class="nt">&gt;&lt;/c:out&gt;</span>" /&gt;
 <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image"</span> <span class="na">content=</span><span class="s">"&lt;c:out value="</span><span class="err">${</span><span class="na">image</span><span class="err">}"</span><span class="nt">&gt;&lt;/c:out&gt;</span>" /&gt;
 <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:description"</span> <span class="na">content=</span><span class="s">"&lt;c:out value="</span><span class="err">${</span><span class="na">description</span><span class="err">}"</span><span class="nt">&gt;&lt;/c:out&gt;</span>" /&gt;</code></pre></figure>

<p>Before returning the JSP page through an API call, we evaluated these meta tags on the server side itself:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/view/{newsId}"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNews</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"newsId"</span><span class="o">)</span> <span class="n">String</span> <span class="n">slug</span><span class="o">,</span> <span class="n">ModelMap</span> <span class="n">mv</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">NewsArticlesV2</span> <span class="n">newsArticlesV2</span> <span class="o">=</span> <span class="n">newsServiceV2</span><span class="o">.</span><span class="na">getByExternalId</span><span class="o">(</span><span class="n">slug</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">title</span> <span class="o">=</span> <span class="n">newsArticlesV2</span><span class="o">.</span><span class="na">getArticleTitle</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">description</span> <span class="o">=</span> <span class="n">newsArticlesV2</span><span class="o">.</span><span class="na">getNewsContent</span><span class="o">();</span>

        <span class="n">String</span> <span class="n">image</span> <span class="o">=</span> <span class="n">newsArticlesV2</span><span class="o">.</span><span class="na">getImage</span><span class="o">();</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"text/html"</span><span class="o">);</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"title"</span><span class="o">,</span> <span class="n">title</span><span class="o">);</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"image"</span><span class="o">,</span> <span class="n">image</span><span class="o">);</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"description"</span><span class="o">,</span> <span class="n">description</span><span class="o">);</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"slug"</span><span class="o">,</span><span class="n">slug</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"request"</span><span class="o">,</span><span class="n">request</span><span class="o">);</span>
        <span class="k">return</span> <span class="s">"webforms/news"</span><span class="o">;</span>
    <span class="o">}</span></code></pre></figure>

<p>And the result becomes:</p>

<p><img src="/images/Blog/angular2.png" alt=""></p>

			<footer>
				<div class="blocked tags">
					<p>
					
						<a href="/blog/tags/angularjs">AngularJs</a> |
					
					</p>
				</div>
			</footer>
			
			<br/>
		
			
			
			<div class="hr"></div>

		


			<!-- Discus Comments -->
			<div id="disqus_thread"></div>

			
			<!-- Enable Disqus comments -->
			<script type="text/javascript">
  var disqus_developer = 0; // developer mode is on
  var disqus_shortname = 'madhur';
  var disqus_identifier = '/2016/04/09/making-angular-play-nice-with-social-sharing/';
  var disqus_title = 'Making AngularJs play nice with Social sharing';
  var disqus_url = 'http://madhur.co.in/blog/2016/04/09/making-angular-play-nice-with-social-sharing.html';
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();

</script>

			
			
			
			

		</article>

		<div class="c">&nbsp;</div>

	</div>

	
</section>
 
<div class="c">&nbsp;</div>


  
<script type="text/javascript">
    
    var disqus_shortname = 'madhur'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

 

 



        </div>


        <footer id="footer" class="row">

            <p id="copyright">
                &copy; 2011-2017 Madhur Ahuja
            </p>
            <p id="poweredby" class="visible-lg visible-md">
                Powered by
                <a href="http://jekyllrb.com" title="A static, minimalist CMS">Jekyll</a>, <a href="http://github.com/">Github</a> and <a href="http://disqus.com">Disqus</a>.
            </p>

            <div class="c">&nbsp;</div>


        </footer>


    </div>

    <script data-main="/files/js/app" src="/files/js/require.js"></script>

    
        <script type="text/javascript">
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-23769089-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
    

    <!-- serviceWorker.html -->
<script>
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/serviceWorker.js').then(function(reg) {
        if (!reg.installing) return;
        console.log("[*] ServiceWorker is installing...");

        var worker = reg.installing;
        worker.addEventListener('statechange', function() {
            if (worker.state == 'redundant') {
                console.log('[*] Install failed');
            }
            if (worker.state == 'installed') {
                console.log('[*] Install successful!');
            }
        });
    });
}

</script>

</body>

</html>
